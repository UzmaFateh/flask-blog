<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Blog</title>
  <script src="https://cdn.tailwindcss.com"></script>





</head>

<body class="bg-gray-100 text-gray-800 font-sans">

  {% extends "base.html" %}
  {% block content %}
  <!-- Page content here -->


  <!-- Navbar -->
  

  <!-- âœ… HERO SECTION (only latest one post) -->

  {% if posts %}
  {% set latest_post = posts[0] %}
  <section class="max-w-6xl mx-auto px-4 mt-10">
    <div class="bg-white rounded-xl shadow-lg overflow-hidden flex flex-col md:flex-row">

      <!-- Left: Image -->
      <div class="md:w-1/2 h-72 md:h-auto relative group">
        <a href="{{ url_for('post_detail', slug=latest_post.slug) }}">
          {% if latest_post.image_filename %}
          {# CHANGE 1: Hero Image using Cloudinary Helper Function #}
          <img src="{{ get_cloudinary_url(latest_post.image_filename, width=800, height=450) }}"
            class="w-full h-full object-cover group-hover:opacity-90 transition duration-300">
          {% else %}
          <div class="w-full h-full bg-gray-200 flex items-center justify-center text-gray-500">
            No Image
          </div>
          {% endif %}
          <!-- Overlay Title on Image -->
          <div
            class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent text-white p-4 text-xl font-semibold">
            {{ latest_post.title }}
          </div>
        </a>
      </div>

      <!-- Right: Category + Title + Description -->
      <div class="md:w-1/2 p-6 flex flex-col justify-between">
        <div>
          <!-- Category -->
          <a href="{{ url_for('posts_by_category', category_name=latest_post.category) }}"
            class="inline-block bg-indigo-100 text-indigo-800 text-xs px-3 py-1 rounded-full mb-3">
            {{ latest_post.category }}
          </a>

          <!-- Title (added here) -->
          <h2 class="text-2xl font-bold text-gray-800 mb-4">
            <a href="{{ url_for('post_detail', slug=latest_post.slug) }}" class="hover:text-indigo-600">
              {{ latest_post.title }}
            </a>
          </h2>

          <!-- Description -->
          <p class="text-gray-700 text-base mb-6 leading-relaxed">
            {{ latest_post.content.split()[:40] | join(' ') }}...
          </p>
        </div>

        <!-- Date + Read More -->
        <div class="flex justify-between items-center">
          <span class="text-gray-500 text-sm">{{ latest_post.created_at.strftime('%Y-%m-%d') }}</span>
          <a href="{{ url_for('post_detail', slug=latest_post.slug) }}"
            class="bg-indigo-600 hover:bg-indigo-700 text-white text-sm px-4 py-2 rounded-lg">
            Read More â†’
          </a>
        </div>
      </div>
    </div>
  </section>
  {% endif %}


  <!-- âœ… OTHER POSTS (Cards) -->
  

  <div class="max-w-6xl mx-auto px-4 mt-12 grid grid-cols-1 lg:grid-cols-12 gap-8 ">

  
<!-- Left: More Posts (9/12 = 3/4 width) -->
<div class="lg:col-span-8 grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3">
  {% set columns = 3 %}
  {% set num_posts_to_show = columns * 2 %} <!-- 2 rows x 3 cards = 6 posts -->

  {# âœ… Exclude the first (hero) post using slice [1:...] #}
  {% for post in posts[1:num_posts_to_show+1] %}
  <div
    class="bg-white rounded-xl shadow hover:shadow-xl transform hover:-translate-y-1 transition duration-300 flex flex-col h-full">
    <a href="{{ url_for('post_detail', slug=post.slug) }}">
      {% if post.image_filename %}
      {# CHANGE 2: Post Card Image using Cloudinary Helper Function #}
      <img src="{{ get_cloudinary_url(post.image_filename, width=400, height=200) }}"
        class="w-full h-32 md:h-36 object-cover rounded-t-xl hover:opacity-90 transition duration-300">
      {% else %}
      <div class="w-full h-32 md:h-36 bg-gray-200 flex items-center justify-center text-gray-500 rounded-t-xl">
        No Image
      </div>
      {% endif %}
    </a>

    <div class="p-3 flex flex-col flex-1">
      <h3 class="text-sm md:text-base font-semibold mb-1 md:mb-2 line-clamp-2">{{ post.title }}</h3>
      <p class="text-gray-500 text-xs md:text-sm flex-1 line-clamp-3">
        {{ post.content.split()[:15] | join(' ') }}...
      </p>
      <a href="{{ url_for('post_detail', slug=post.slug) }}"
        class="mt-2 md:mt-3 bg-indigo-600 hover:bg-indigo-700 text-white text-xs md:text-sm px-3 py-1 md:px-4 md:py-2 rounded-lg text-center">
        Read More
      </a>
    </div>
  </div>
  {% endfor %}

  <!-- âœ… See More Button -->
  {% if posts|length > num_posts_to_show + 1 %} {# +1 because hero excluded #}
  <div class="col-span-full text-center mt-4">
    <a href="{{ url_for('all_posts', page=1) }}"
      class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg shadow transition">
      See More
    </a>
  </div>
  {% endif %}
</div>


    <!-- Right: Editorâ€™s Picks Vertical Slider (3/12 = narrower) -->
<div class="lg:col-span-4 flex flex-col h-[630px] border rounded-xl shadow-lg overflow-hidden relative">
  <h3 class="text-lg font-bold text-gray-800 p-4 border-b">Top 10 Editor's Picks</h3>

  <!-- Slider Buttons -->
  <button id="editorUpBtn"
    class="absolute top-2 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow hover:bg-indigo-700">â†‘</button>
  <button id="editorDownBtn"
    class="absolute bottom-2 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow hover:bg-indigo-700">â†“</button>

  <!-- Slider Container -->
  <div id="editorSlider" class="flex-1 overflow-hidden relative">
    <div id="editorSliderInner" class="flex flex-col">
      {% for post in editor_picks[:10] %}
      <a href="{{ url_for('post_detail', slug=post.slug) }}"
        class="flex items-center gap-3 p-3 hover:bg-gray-100 border-b h-20 md:h-24 flex-shrink-0">
        {# CHANGE 3: Editor's Pick Thumbnail using Cloudinary Helper Function #}
        <img src="{{ get_cloudinary_url(post.image_filename, width=80, height=80) }}"
          class="w-16 h-16 md:w-20 md:h-20 object-cover rounded-md flex-shrink-0">
        <div class="flex-1">
          <h4 class="text-sm md:text-base font-semibold text-gray-800 line-clamp-2">{{ post.title }}</h4>
          <p class="text-gray-500 text-xs md:text-sm">{{ post.created_at.strftime('%Y-%m-%d') }}</p>
        </div>
      </a>
      {% endfor %}
    </div>
  </div>

  <!-- See More Button -->
  <div class="p-4 text-center border-t">
    <a href="{{ url_for('editors_picks', page=1) }}"
      class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg shadow transition">
      See More
    </a>
  </div>
</div>

<script>
  // Unique variables for Editor's Picks
  const editorSliderContainer = document.getElementById('editorSlider');
  const editorSliderInner = document.getElementById('editorSliderInner');
  const editorUpBtn = document.getElementById('editorUpBtn');
  const editorDownBtn = document.getElementById('editorDownBtn');

  // Ensure elements exist before accessing properties
  if (editorSliderInner && editorSliderInner.children.length > 0) {
    const editorCardHeight = editorSliderInner.children[0].offsetHeight;
    const editorCards = Array.from(editorSliderInner.children);

    // Clone cards for seamless scrolling
    editorCards.forEach(card => {
      editorSliderInner.appendChild(card.cloneNode(true));
    });

    let editorScrollPosition = 0;
    const editorMaxScroll = editorSliderInner.scrollHeight / 2;

    function editorMoveDown() {
      editorScrollPosition += editorCardHeight;
      if (editorScrollPosition >= editorMaxScroll) {
        editorScrollPosition = 0;
        editorSliderContainer.scrollTop = 0;
      } else {
        editorSliderContainer.scrollBy({ top: editorCardHeight, behavior: 'smooth' });
      }
    }

    function editorMoveUp() {
      editorScrollPosition -= editorCardHeight;
      if (editorScrollPosition < 0) {
        editorScrollPosition = editorMaxScroll - editorCardHeight;
        editorSliderContainer.scrollTop = editorScrollPosition;
      } else {
        editorSliderContainer.scrollBy({ top: -editorCardHeight, behavior: 'smooth' });
      }
    }

    let editorAutoScroll = setInterval(editorMoveDown, 1000);

    editorDownBtn.addEventListener('click', () => {
      editorMoveDown();
      clearInterval(editorAutoScroll);
      editorAutoScroll = setInterval(editorMoveDown, 1000);
    });

    editorUpBtn.addEventListener('click', () => {
      editorMoveUp();
      clearInterval(editorAutoScroll);
      editorAutoScroll = setInterval(editorMoveDown, 1000);
    });
  }
</script>






  <!-- ðŸ”¥ Popular Posts -->

  <section class="max-w-6xl mx-auto px-4 mt-12">
    <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b-2 border-gray-300 pb-2">Most Popular</h2>

    <div class="relative">
      <!-- Slider Buttons -->
      <button id="prevBtn"
        class="absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow hover:bg-indigo-700">â€¹</button>
      <button id="nextBtn"
        class="absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow hover:bg-indigo-700">â€º</button>

      <!-- Slider Container -->
      <div id="slider" class="flex gap-6 overflow-hidden">
        {% for post in popular_posts %}
        <!-- <div class="bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1 transition-all duration-300 flex-shrink-0 w-60"> -->
        <div class="card bg-white rounded-xl shadow-lg transform transition-transform duration-300 flex-shrink-0 w-72 hover:scale-105 hover:shadow-2xl">
        
          {% if post.image_filename %}
          <a href="{{ url_for('post_detail', slug=post.slug) }}">
            {# CHANGE 4: Popular Post Slider Image using Cloudinary Helper Function #}
            <img src="{{ get_cloudinary_url(post.image_filename, width=300, height=200) }}"
              class="w-full h-40 object-cover rounded-t-xl">
          </a>
          {% endif %}
          <div class="p-4 flex flex-col justify-between h-40">
            <h3 class="text-lg font-semibold mb-2">
              <a href="{{ url_for('post_detail', slug=post.slug) }}" class="hover:text-indigo-600">{{ post.title }}</a>
            </h3>
            <p class="text-gray-500 text-sm">{{ post.views }} views</p>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>

  <script>
    const slider = document.getElementById('slider');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    // Ensure the slider and its children exist before calculating dimensions
    if (slider && slider.children.length > 0) {
        // Updated scroll amount calculation based on the w-72 (288px) and gap-6 (24px)
        const scrollAmount = 288 + 24; 

        // Duplicate all cards for seamless looping
        const cards = Array.from(slider.children);
        cards.forEach(card => {
          const clone = card.cloneNode(true);
          slider.appendChild(clone);
        });

        let scrollPosition = 0;
        const maxScroll = slider.scrollWidth / 2; // only original cards width

        function moveNext() {
          scrollPosition += scrollAmount;

          if (scrollPosition >= maxScroll) {
            scrollPosition = 0;
            slider.scrollLeft = 0;
          } else {
            slider.scrollBy({ left: scrollAmount, behavior: 'smooth' });
          }
        }

        function movePrev() {
          scrollPosition -= scrollAmount;

          if (scrollPosition < 0) {
            scrollPosition = maxScroll - scrollAmount;
            slider.scrollLeft = scrollPosition;
          } else {
            slider.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
          }
        }

        // Automatic scroll every 3 seconds
        let autoScroll = setInterval(moveNext, 1000);

        // Buttons
        nextBtn.addEventListener('click', () => {
          moveNext();
          clearInterval(autoScroll);
          autoScroll = setInterval(moveNext, 1000);
        });

        prevBtn.addEventListener('click', () => {
          movePrev();
          clearInterval(autoScroll);
          autoScroll = setInterval(moveNext, 1000);
        });
    }
  </script>


  <script src="script.js"></script>


  {% endblock %}
</body>

</html>